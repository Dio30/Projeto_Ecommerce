{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="{% static 'css/mstyle.css' %}">
    <link rel="shortcut icon" href="{% static 'imagens/6+cart.png' %}" type="image/x-icon">
</head>
<body>
    
    {% block main %}
    {% endblock %}

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="{% static 'js/cart.js' %}"></script>
    
    <script type="text/javascript">
        var user = '{{ request.user }}'

        function get_token(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        var csrftoken = get_token('csrftoken');
    </script>
    <script type="text/javascript">
        var button = document.getElementById("search-button");
        
        button.onclick = function() {
            var cep = document.getElementById("cep-input").value;
            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://cep.awesomeapi.com.br/json/' + cep);
            xhr.onreadystatechange = function() {
            if (xhr.readyState === 4 && xhr.status === 200) {
                var data = JSON.parse(xhr.responseText);
                document.getElementById("address").value = data.address;
                document.getElementById("city").value = data.city;
                document.getElementById("state").value = data.state;
                console.log(data)
                console.log(data.address)
                console.log(data.city)
                console.log(data.state)
            }
            };
            xhr.send();
        }
        </script>
</body>
</html>